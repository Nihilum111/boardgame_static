# Boardgame Statistic

## Описание проекта

**Boardgame Statistic** — это мобильное приложение для ведения статистики игр, которое позволяет:
- Просматривать список игровых партий;
- Отслеживать информацию о настольных играх;
- Просматривать подробное описание выбранной настольной игры.

Приложение построено с использованием **Jetpack Compose** и реализовано на платформе **Android** с использованием языка **Kotlin**. В качестве back-end используется **FastAPI** на языке **Python** с ORM **SQLAlchemy** для работы с базой данных.

Проект организован как монорепозиторий:
- **Android-приложение** находится в папке `app/`.
- **Backend** на FastAPI находится в папке `backend/`.

## Структура проекта

.
├── app
│ ├── build.gradle.kts // Конфигурация Gradle для Android-приложения
│ └── src/main/
│ ├── java/com/example/boardgamestatistic/
│ │ ├── MainActivity.kt // Точка входа Android-приложения
│ │ ├── models/
│ │ │ ├── Game.kt // Модель данных для партий/игр
│ │ │ ├── BoardGame.kt // Модель данных для настольной игры (id, title, short_description)
│ │ │ └── PlayerScore.kt // (Опционально) модель для результатов игроков
│ │ ├── network/
│ │ │ ├── RetrofitInstance.kt // Инициализация Retrofit клиента с настройкой baseURL и конвертеров
│ │ │ └── GameApiService.kt // Определение API-эндпоинтов для взаимодействия с backend
│ │ ├── ui/
│ │ │ ├── NavigationComponent.kt // Маршрутизация между экранами через Compose Navigation
│ │ │ ├── HomePagerScreen.kt // Горизонтальный Pager, объединяющий экраны «Список партий» и «Настольные игры»
│ │ │ ├── PartyListScreen.kt // Экран «Список партий»: отображает список игровых партий, загружаемый через GameViewModel
│ │ │ ├── BoardGamesScreen.kt // Экран «Настольные игры»: выводит список настольных игр с фильтром по названию, поддерживает свайп и навигацию
│ │ │ └── BoardGameDetailScreen.kt // Экран «Детальное описание»: показывает подробности (название и описание) настольной игры; поддерживает вертикальную прокрутку
│ │ └── viewmodel/
│ │ └── GameViewModel.kt // ViewModel для получения и хранения данных о партиях и играх из backend
│ └── res/
│ └── layout/ // XML-ресурсы (если используются), иконки, строки и т.д.
├── backend
│ ├── main.py // Точка входа backend-приложения на FastAPI. Здесь:
│ │ - Настраивается подключение к базе данных (SQLAlchemy).
│ │ - Определяются модели базы данных для таблиц games и boardgames.
│ │ - Определяются Pydantic модели (например, BoardGameDetailResponse) для валидации данных.
│ │ - Реализованы API-эндпоинты:
│ │ • GET /games/ – получение списка игровых партий.
│ │ • POST /games/ – создание новой игровой партии.
│ │ • GET /games/{id} – получение деталей конкретной игровой партии.
│ │ • GET /boardgames/ – получение списка настольных игр (с возможностью фильтрации по title).
│ │ • GET /boardgames/{id} – получение подробной информации о конкретной настольной игре.
│ ├── requirements.txt // Список зависимостей Python (FastAPI, SQLAlchemy, uvicorn, pydantic и др.)
│ └── .env // Переменные окружения (например, DATABASE_URL, SECRET_KEY)
├── .gitignore // Список файлов и папок, игнорируемых Git (например, сборки, .env)
└── README.md // Этот файл с подробным описанием проекта

## Детальное описание ключевых компонентов

### Android-приложение (`app/`)

#### 1. **MainActivity.kt**
- **Назначение:**  
  Точка входа для приложения. Здесь происходит установка Compose-контента и базовая настройка навигации.
- **Основные функции:**  
  Инициализация навигационной системы, запуск HomePagerScreen.

#### 2. **Модели (`app/src/main/java/com/example/boardgamestatistic/models/`)**
- **Game.kt:**  
  Содержит информацию о игровой партии (например, id, название, дата, количество игроков и т.д.).
- **BoardGame.kt:**  
  Представляет данные о настольной игре. Поля:
  - `id`: уникальный идентификатор;
  - `title`: название игры;
  - `short_description`: краткое описание (может быть пустым).
- **PlayerScore.kt (опционально):**  
  Используется для хранения результатов игроков, если эта функциональность понадобится.

#### 3. **Сетевой слой (`app/src/main/java/com/example/boardgamestatistic/network/`)**
- **RetrofitInstance.kt:**  
  Инициализирует клиента Retrofit с базовым URL, необходимыми конвертерами (Gson или Moshi) и настройками для логирования.
- **GameApiService.kt:**  
  Интерфейс, определяющий REST API методы:
  - `getGames()`: получение списка игровых партий.
  - `getBoardGames()`: получение списка настольных игр с поддержкой фильтрации.
  - `getBoardGameById(id: Int)`: получение подробной информации о настольной игре.
  - `createGame(game: Game)`: создание новой игры.

#### 4. **UI-компоненты (`app/src/main/java/com/example/boardgamestatistic/ui/`)**
- **NavigationComponent.kt:**  
  Отвечает за маршрутизацию в приложении. Определяются маршруты для:
  - Главного экрана (HomePagerScreen),
  - Детального экрана игровой партии (при необходимости),
  - Экрана добавления новой игры,
  - Экрана деталей настольной игры – маршрут `boardGameDetail/{boardGameId}`.
- **HomePagerScreen.kt:**  
  Объединяет два экрана через горизонтальный свайп:
  - «Список партий» (PartyListScreen),
  - «Настольные игры» (BoardGamesScreen).
- **PartyListScreen.kt:**  
  Отображает список игровых партий с использованием ViewModel для загрузки данных. Данные запрашиваются один раз при запуске.
- **BoardGamesScreen.kt:**  
  Позволяет пользователю:
  - Ввести текстовый фильтр для поиска настольных игр по названию.
  - Просматривать список карточек настольных игр.
  - При клике на карточку происходит навигация на экран деталей.
  - Помимо TopAppBar здесь реализована обработка физической кнопки "Назад" с помощью `BackHandler`.
- **BoardGameDetailScreen.kt (переименованный в «Детальное описание»):**  
  Отображает подробное описание выбранной настольной игры:
  - Заголовок экрана – «Детальное описание».
  - Используется `verticalScroll` для возможности прокрутки длинных описаний.
  - Реализован запрос через Retrofit на получение данных о настольной игре по `id`.

#### 5. **ViewModel (`app/src/main/java/com/example/boardgamestatistic/viewmodel/GameViewModel.kt`)**
- **Назначение:**  
  Организация бизнес-логики приложения. ViewModel:
  - Получает список игровых партий с backend;
  - Обновляет UI через потоки данных (LiveData или State);
  - Позволяет при необходимости повторно запрашивать данные.

### Backend-приложение (`backend/`)

#### 1. **main.py**
- **Основные функции:**
  - Настройка подключения к базе данных через SQLAlchemy.
  - Определение моделей БД для таблиц `games` и `boardgames`. Например:
    - `games`: хранит информацию о игровых партиях;
    - `boardgames`: хранит данные о настольных играх (включая поля `id`, `title`, `short_description`, `logo_url`, `title_ru` и т.д.).
  - Определение Pydantic моделей для сериализации и валидации данных:
    - `GameResponse`
    - `BoardGameResponse`
    - `BoardGameDetailResponse` – используется для возврата подробностей настольной игры (название и краткое описание).
  - Реализация REST API-эндпоинтов:
    - `GET /games/` – получает список игровых партий.
    - `POST /games/` – создаёт новую игровую партию.
    - `GET /games/{id}` – возвращает детали конкретной партии.
    - `GET /boardgames/` – возвращает список настольных игр с возможностью фильтрации по параметру `search`.
    - `GET /boardgames/{id}` – возвращает детальную информацию о настольной игре.

#### 2. **requirements.txt**
- Содержит зависимости Python, необходимые для работы backend:
  - fastapi
  - uvicorn
  - sqlalchemy
  - pydantic
  - psycopg2 или другие драйверы, если используется PostgreSQL

#### 3. **.env**
- Файл с переменными окружения, например:
  - `DATABASE_URL` – строка подключения к базе данных;
  - `SECRET_KEY` – секретный ключ для приложения;
  - Другие настройки конфигурации.

## Как запустить проект

### Запуск Android-приложения
1. **Открытие проекта:**  
   Откройте проект в Android Studio.
2. **Проверка зависимостей:**  
   Убедитесь, что все зависимости указаны в `build.gradle.kts` и синхронизированы.
3. **Запуск приложения:**  
   Подключите устройство или запустите эмулятор и выполните сборку/запуск через Android Studio.

### Запуск Backend
1. **Установка зависимостей:**  
   Откройте терминал, перейдите в папку `backend/` и выполните:
   ```bash
   pip install -r requirements.txt
   ```
2. **Настройка переменных окружения:**  
   Убедитесь, что в файле `.env` прописаны все необходимые переменные.
3. **Запуск сервера:**  
   Запустите сервер командой:
   ```bash
   uvicorn main:app --reload --host 0.0.0.0 --port 8008
   ```
   API будет доступен по адресу `http://localhost:8008/`, а интерактивная документация по адресу `http://localhost:8008/docs`.

## Посмотр взаимосвязи компонентов

- **Интеграция API:**  
  Android-приложение общается с backend через Retrofit. Все запросы (получение списка партий, настольных игр, деталей игры) асинхронно обрабатываются с помощью Retrofit-интерфейса `GameApiService.kt`.
  
- **Навигация:**  
  Основная навигация управляется через `NavigationComponent.kt`. Пользователь может переключаться между горизонтальными экранами: «Список партий» и «Настольные игры». При выборе конкретной настольной игры происходит переход на экран «Детальное описание».
  
- **Обработка системных событий:**  
  Экран «Настольные игры» обрабатывает физическую кнопку "Назад" с помощью `BackHandler`, что позволяет перейти к экрану «Список партий».

## Лучшие практики и рекомендации

- **Разделение ответственности:**  
  Frontend и backend логически разделены, что позволяет независимо масштабировать и развивать каждую часть.
- **Версионирование:**  
  Проект полностью управляется системой контроля версий Git. Рекомендуется создавать теги для релизов (например, v0.1, v0.2), чтобы можно было вернуться к стабильной версии.
- **Модульность:**  
  Организация кода в отдельные модули (сети, UI, модели, ViewModels) упрощает сопровождение, тестирование и добавление новых возможностей.
- **Документирование:**  
  Комментарии в коде и подробное описание в README помогают новым участникам проекта быстро вникнуть в архитектуру и назначение основных компонентов.
- **CI/CD:**  
  Возможна интеграция с GitLab CI или другим CI/CD-инструментом для автоматизированного тестирования и развертывания приложения.

## Возможные улучшения

- **Расширение API:**  
  Добавление эндпоинтов для обновления и удаления записей игр, улучшение фильтрации и пагинации.
- **UI/UX:**  
  Улучшение визуального оформления, анимаций, а также реализация поддержки различных разрешений экрана.
- **Тестирование:**  
  Написание модульных и интеграционных тестов для Android-приложения и backend.
- **Логирование и мониторинг:**  
  Добавление серверного логирования и системы мониторинга для контроля производительности и ошибок.

## Заключение

Проект **Boardgame Statistic** демонстрирует:
- Современный подход к разработке Android-приложений с использованием Jetpack Compose и Retrofit.
- Надёжное серверное решение с FastAPI и SQLAlchemy.
- Чёткое разделение бизнес-логики, UI и сетевого взаимодействия.
- Возможность масштабирования и модульного развития как фронтенд, так и бэкенд компонентов.

Данный README.md поможет разработчикам быстро погрузиться в проект, понять его архитектуру и начать работу над новыми фичами или улучшениями.